import{c as f,r as d,j as e}from"./index-Cajg6Qr7.js";import{b as j,i as b,j as u}from"./useSpaceTraders-DaRezP3D.js";import{f as h,b as g}from"./helpers-DIVcxWFQ.js";import{L as N}from"./LoadingState-CrclXfPb.js";import{F as v}from"./file-text-BeH1VzNn.js";import{P as y}from"./package-QTFXR8Bq.js";import{C}from"./clock-B4d008v6.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],A=f("circle-check-big",w),P=()=>{const{data:a,isLoading:r}=j(),c=b(),i=u(),o=d.useCallback(async s=>{try{await c.mutateAsync(s),alert("Contract accepted!")}catch(l){alert(l.response?.data?.error?.message||"Failed to accept contract")}},[c]),t=d.useCallback(async s=>{try{await i.mutateAsync(s),alert("Contract fulfilled!")}catch(l){alert(l.response?.data?.error?.message||"Failed to fulfill contract")}},[i]);if(r)return e.jsx("div",{className:"p-6",children:e.jsx(N,{label:"Contracts",description:"Negotiating with faction brokers..."})});const{activeContracts:n,availableContracts:x,completedContracts:p}=d.useMemo(()=>{const s=a??[];return{activeContracts:s.filter(l=>l.accepted&&!l.fulfilled),availableContracts:s.filter(l=>!l.accepted),completedContracts:s.filter(l=>l.fulfilled)}},[a]);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Contracts"}),e.jsx("p",{className:"text-gray-400",children:"Manage your faction contracts and deliveries"})]}),n.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Active Contracts"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:n.map(s=>e.jsx(m,{contract:s,onFulfill:t,status:"active"},s.id))})]}),x.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Available Contracts"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:x.map(s=>e.jsx(m,{contract:s,onAccept:o,status:"available"},s.id))})]}),p.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Completed Contracts"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:p.map(s=>e.jsx(m,{contract:s,status:"completed"},s.id))})]}),a&&a.length===0&&e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(v,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No contracts available"})]})]})},m=d.memo(({contract:a,onAccept:r,onFulfill:c,status:i})=>{const o=a.terms.deliver.every(t=>t.unitsFulfilled>=t.unitsRequired);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:a.type}),e.jsx("p",{className:"text-sm text-gray-400",children:a.factionSymbol})]}),i==="available"&&e.jsx("span",{className:"badge badge-info",children:"Available"}),i==="active"&&e.jsx("span",{className:"badge badge-warning",children:"In Progress"}),i==="completed"&&e.jsx("span",{className:"badge badge-success",children:"Completed"})]}),e.jsx("div",{className:"space-y-3 mb-4",children:a.terms.deliver.map((t,n)=>e.jsxs("div",{className:"p-3 bg-gray-800/50 rounded",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.tradeSymbol})]}),e.jsxs("span",{className:"text-xs text-gray-400",children:[t.unitsFulfilled," / ",t.unitsRequired]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${t.unitsFulfilled/t.unitsRequired*100}%`}})}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Deliver to: ",t.destinationSymbol]})]},n))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 p-3 bg-gray-800/30 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"On Accepted"}),e.jsx("p",{className:"text-sm font-semibold text-green-400",children:h(a.terms.payment.onAccepted)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"On Fulfilled"}),e.jsx("p",{className:"text-sm font-semibold text-green-400",children:h(a.terms.payment.onFulfilled)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-4",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsx("span",{children:i==="available"?`Accept by: ${g(a.deadlineToAccept)}`:`Complete by: ${g(a.terms.deadline)}`})]}),i==="available"&&r&&e.jsx("button",{onClick:()=>r(a.id),className:"btn-primary w-full",children:"Accept Contract"}),i==="active"&&c&&o&&e.jsxs("button",{onClick:()=>c(a.id),className:"btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Fulfill Contract"]})]})});m.displayName="ContractCard";export{P as default};
